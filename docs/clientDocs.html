<!DOCTYPE html>

<html>
<head>
  <title>clientDocs.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>clientDocs.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              <h2 id="routing-and-configuration">Routing and Configuration</h2>

            </div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>angular.module(<span class="hljs-string">'queup'</span>, [
  <span class="hljs-string">'queup.newClass'</span>,
  <span class="hljs-string">'queup.teacher'</span>,
  <span class="hljs-string">'queup.auth'</span>,
  <span class="hljs-string">'socket.io'</span>,
  <span class="hljs-string">'queup.sinch'</span>,
  <span class="hljs-string">'queup.auth'</span>,
  <span class="hljs-string">'queup.before'</span>,
  <span class="hljs-string">'queup.class_list'</span>,
  <span class="hljs-string">'queup.new_class'</span>,
  <span class="hljs-string">'queup.in_session'</span>,
  <span class="hljs-string">'queup.queue_list'</span>,
  <span class="hljs-string">'queup.student_list'</span>,
  <span class="hljs-string">'ui.router'</span>
])
.config(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">($stateProvider, $urlRouterProvider)</span></span>{
  
  $stateProvider
    .state(<span class="hljs-string">'signin'</span>, {
      url: <span class="hljs-string">'/signin'</span>,
      views: {
        <span class="hljs-string">'main'</span>: {
          templateUrl: <span class="hljs-string">'auth/signin.html'</span>,
          controller: <span class="hljs-string">'AuthController'</span>
        }
      }
    })
    .state(<span class="hljs-string">'q'</span>, {
      url:<span class="hljs-string">"/q"</span>,
      views: {
        <span class="hljs-string">'main'</span>: {
          templateUrl: <span class="hljs-string">"nav.html"</span>,
          controller: <span class="hljs-string">'AuthController'</span>
        }
      },
      resolve: {
        authenticate: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(auth)</span> </span>{
          <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'calling auth.checkLoginState'</span>)
          <span class="hljs-keyword">return</span> auth.checkLoginState();
        },
        dataLoaded: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(teacherData)</span> </span>{
          <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'is this also promise?'</span>, teacherData.get(<span class="hljs-string">'loading'</span>));
          <span class="hljs-keyword">return</span> teacherData.update(<span class="hljs-string">'resolve'</span>);
        }
      }
    })
    .state(<span class="hljs-string">'q.before_session'</span>, {
      url: <span class="hljs-string">'/before_session'</span>, 
      views: {
        <span class="hljs-string">'nav'</span>: {
          templateUrl: <span class="hljs-string">'before_session/before_session.html'</span>,
          controller: <span class="hljs-string">'Before_sessionController'</span>,
        }
      }
    })
    .state(<span class="hljs-string">'q.before_session.class_info'</span>, {
      url: <span class="hljs-string">'/class_info'</span>,
      views: {
        <span class="hljs-string">'sub'</span>: {
          templateUrl: <span class="hljs-string">'before_session/class_info.html'</span>,
          controller: <span class="hljs-string">'Class_infoController'</span>,
        }
      }
    })
    .state(<span class="hljs-string">'q.before_session.class_list'</span>, {
      url: <span class="hljs-string">'/class_list'</span>,
      views: {
        <span class="hljs-string">'sub'</span>: {
          templateUrl: <span class="hljs-string">'before_session/class_list.html'</span>,
          controller: <span class="hljs-string">'Class_listController'</span>
        }
      }
    })
    .state(<span class="hljs-string">'q.before_session.new_class'</span>, {
      url: <span class="hljs-string">'/new_class'</span>,
      views: {
        <span class="hljs-string">'sub'</span>: {
          templateUrl: <span class="hljs-string">'before_session/new_class.html'</span>,
          controller: <span class="hljs-string">'New_classController'</span>
        }
      }
    })
    .state(<span class="hljs-string">'q.in_session'</span>, {
      url: <span class="hljs-string">'/in_session'</span>,
      views: {
        <span class="hljs-string">'nav'</span>: {
          templateUrl: <span class="hljs-string">'in_session/in_session.html'</span>,
          controller: <span class="hljs-string">'In_sessionController'</span>
        }
      }
    })
    .state(<span class="hljs-string">'q.in_session.queue_list'</span>, {
      url: <span class="hljs-string">'/queue_list'</span>,
      views: {
        <span class="hljs-string">'sub'</span>: {
          templateUrl: <span class="hljs-string">'in_session/queue_list.html'</span>,
          controller: <span class="hljs-string">'Queue_listController'</span>
        }
      }
    })
    .state(<span class="hljs-string">'q.in_session.student_list'</span>, {
      url: <span class="hljs-string">'/student_list'</span>,
      views: {
        <span class="hljs-string">'sub'</span>: {
          templateUrl: <span class="hljs-string">'in_session/student_list.html'</span>,
          controller: <span class="hljs-string">'Student_listController'</span>
        }
      }
    })
    .state(<span class="hljs-string">'q.in_session.class_settings'</span>, {
      url: <span class="hljs-string">'/class_settings'</span>,
      views: {
        <span class="hljs-string">'sub'</span>: {
          templateUrl: <span class="hljs-string">'in_session/class_settings.html'</span>,
          controller: <span class="hljs-string">'Class_settingsController'</span>
        }
      }
    })

  $urlRouterProvider.otherwise(<span class="hljs-string">'/signin'</span>);
})
.run(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">($rootScope, $state)</span> </span>{
  $rootScope.$on(<span class="hljs-string">'$stateChangeError'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(event, toState, toParams, fromState, fromParams, error)</span> </span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'there has been error!'</span>, event, toState, toParams, fromState, fromParams, error)</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>Redirect to login page</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    $state.go(<span class="hljs-string">'signin'</span>);
  });

})


.run(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">($rootScope, $window, teacherData, auth, $state)</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>This is called with the results from FB.getLoginStatus().</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  $<span class="hljs-built_in">window</span>.statusChangeCallback = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(response)</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>The response object is returned with a status field that lets the
app know the current login status of the person.
Full docs on the response object can be found in the documentation
for FB.getLoginStatus().</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span> (response.status === <span class="hljs-string">'connected'</span>) {</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>Logged into your app and Facebook.
auth.testAPI();</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">var</span> access_token =   FB.getAuthResponse()[<span class="hljs-string">'accessToken'</span>];
      $<span class="hljs-built_in">window</span>.localStorage.setItem( <span class="hljs-string">'clientToken'</span>, access_token);

      <span class="hljs-keyword">if</span>(teacherData.get(<span class="hljs-string">'loaded'</span>)) {
        $state.go(<span class="hljs-string">'q.before_session.class_list'</span>);
      } <span class="hljs-keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>Load teacher data into teacherData service, then go to Class List state</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        teacherData.update(<span class="hljs-string">'FB'</span>).then(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>$scope.dataLoaded = teacherData.get(‘loaded’)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        }).then(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>auth.loggedIn = true;</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          $state.go(<span class="hljs-string">'q.before_session.class_list'</span>)
        });
      }
      

    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (response.status === <span class="hljs-string">'not_authorized'</span>) {</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>The person is logged into Facebook, but not your app.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    } <span class="hljs-keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>The person is not logged into Facebook, so we’re not sure if
they are logged into this app or not.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    }
  }</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>This function is called when someone finishes with the Login Button.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  $<span class="hljs-built_in">window</span>.checkLoginState = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">checkLoginState</span><span class="hljs-params">()</span> </span>{

    FB.getLoginStatus(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(response)</span> </span>{
      $<span class="hljs-built_in">window</span>.statusChangeCallback(response);
    });
  }

  $<span class="hljs-built_in">window</span>.fbAsyncInit = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{

    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'FB calling FB.getLoginStatus'</span>)
    FB.getLoginStatus(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(response)</span> </span>{
     $<span class="hljs-built_in">window</span>.statusChangeCallback(response);
    });

  };
});
angular.module(<span class="hljs-string">'queup.auth'</span>, [])</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>Sign-in Controller</p>
<hr>

            </div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>Provides login and logout interface for Facebook authorization</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>.controller(<span class="hljs-string">'AuthController'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">($scope, $state, teacherData, auth, $window)</span></span>{

  $scope.logout =  <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{
    FB.logout();
    $state.go(<span class="hljs-string">'signin'</span>);
  }

  $scope.login = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
    FB.login(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(response)</span> </span>{
      $<span class="hljs-built_in">window</span>.statusChangeCallback(response);
    });
  }

  $scope.teacherName = <span class="hljs-string">''</span>;
  $scope.teacherPic = <span class="hljs-string">''</span>;

  <span class="hljs-keyword">if</span>(teacherData.get(<span class="hljs-string">'loaded'</span>)) {
    $scope.teacherName = teacherData.get(<span class="hljs-string">'name'</span>);
    $scope.teacherPic = teacherData.get(<span class="hljs-string">'fbPicture'</span>);
  }

});</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <h2 id="sign-in-factory">Sign-in Factory</h2>

            </div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>angular.module(<span class="hljs-string">'queup.auth'</span>, [])
.factory(<span class="hljs-string">'auth'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">($q)</span> </span>{
  <span class="hljs-keyword">var</span> auth = {};
  auth.init = <span class="hljs-literal">false</span>;

  auth.checkLoginState = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">var</span> deferred = $q.defer();
    FB.getLoginStatus(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(response)</span> </span>{
      <span class="hljs-keyword">if</span>(response.status === <span class="hljs-string">'connected'</span>) {
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'facebook says you be logged in'</span>);
        deferred.resolve(<span class="hljs-string">'Logged In'</span>);
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'facebook say you not logged in'</span>);
        deferred.reject(response.status)
      }
    });
    <span class="hljs-keyword">return</span> deferred.promise;
  };

  <span class="hljs-keyword">return</span> auth;
})</pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <h2 id="new-class-factory">New Class Factory</h2>

            </div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>angular.module(<span class="hljs-string">'queup.newClass'</span>, [])

.factory(<span class="hljs-string">'queupFactory'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">($http, $rootScope)</span></span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>Change server URL when setting up for deployment</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  $rootScope.serverURL = <span class="hljs-string">'http://localhost:8000'</span>; <span class="hljs-comment">// 'http://queup.io';</span>

  <span class="hljs-keyword">var</span> addNewClass = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(newClassName)</span></span>{
    <span class="hljs-built_in">console</span>.log(newClassName)
    <span class="hljs-keyword">var</span> token = <span class="hljs-built_in">window</span>.localStorage.getItem(<span class="hljs-string">'clientToken'</span>);
    <span class="hljs-built_in">console</span>.log(token,<span class="hljs-string">"TOKEN"</span>);
    <span class="hljs-keyword">return</span> $http({
      method: <span class="hljs-string">'POST'</span>,
      url: $rootScope.serverURL + <span class="hljs-string">'/api/teachers/addClass'</span>,
      headers: {
        user_role: <span class="hljs-string">'teacher'</span>,
        access_token: token
      },
      dataType: <span class="hljs-string">'JSON'</span>,
      data:{
        classTitle: newClassName
      }
    })
    .success(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(data)</span></span>{
      <span class="hljs-built_in">console</span>.dir(<span class="hljs-string">'add new class: success data below:'</span>);
      <span class="hljs-built_in">console</span>.dir(data);
      <span class="hljs-keyword">return</span> data;
    })
    .error(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(data)</span></span>{
      <span class="hljs-built_in">console</span>.dir(<span class="hljs-string">'error data below:'</span>);
      <span class="hljs-built_in">console</span>.dir(data);
    })
  };

  <span class="hljs-keyword">return</span> {
    addNewClass: addNewClass,
  }
})
angular.module(<span class="hljs-string">'queup.factory'</span>, [])

.factory(<span class="hljs-string">'queupFactory'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">($http, $rootScope)</span></span>{

  $rootScope.serverURL = <span class="hljs-string">'http://localhost:8000'</span>; <span class="hljs-comment">// 'http://queup.io';</span>

  <span class="hljs-keyword">var</span> addNewClass = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(newClassName)</span></span>{
    <span class="hljs-built_in">console</span>.log(newClassName)
    <span class="hljs-keyword">var</span> token = <span class="hljs-built_in">window</span>.localStorage.getItem(<span class="hljs-string">'clientToken'</span>);
    <span class="hljs-built_in">console</span>.log(token,<span class="hljs-string">"TOKEN"</span>);
    <span class="hljs-keyword">return</span> $http({
      method: <span class="hljs-string">'POST'</span>,
      url: $rootScope.serverURL + <span class="hljs-string">'/api/teachers/addClass'</span>,
      headers: {
        user_role: <span class="hljs-string">'teacher'</span>,
        access_token: token
      },
      dataType: <span class="hljs-string">'JSON'</span>,
      data:{
        classTitle: newClassName
      }
    })
    .success(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(data)</span></span>{
      <span class="hljs-built_in">console</span>.dir(<span class="hljs-string">'add new class: success data below:'</span>);
      <span class="hljs-built_in">console</span>.dir(data);
      <span class="hljs-keyword">return</span> data;
    })
    .error(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(data)</span></span>{
      <span class="hljs-built_in">console</span>.dir(<span class="hljs-string">'error data below:'</span>);
      <span class="hljs-built_in">console</span>.dir(data);
    })
  };

  <span class="hljs-keyword">return</span> {
    addNewClass: addNewClass,
  }
})</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <h2 id="sinch-webrtc-factory">Sinch WebRTC Factory</h2>

            </div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>angular.module(<span class="hljs-string">'queup.sinch'</span>, [<span class="hljs-string">'queup.newClass'</span>])

.factory(<span class="hljs-string">'sinch'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(teacherData)</span></span>{

  <span class="hljs-keyword">var</span> sinchClient = <span class="hljs-keyword">new</span> SinchClient({
    applicationKey: <span class="hljs-string">'ccdeeb0b-5733-4bcb-9f44-4b2a7a70dbfe'</span>,
    capabilities: {calling: <span class="hljs-literal">true</span>},</pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <p>This is required if application is to receive calls / instant messages.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    startActiveConnection: <span class="hljs-literal">true</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <p>For additional loging, please uncomment the three rows below</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    onLogMessage: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(message)</span> </span>{
      <span class="hljs-built_in">console</span>.log(message);
    },
  });

  <span class="hljs-keyword">var</span> signUpObj = {
    username: teacherData.get(<span class="hljs-string">'email'</span>),
    password: teacherData.get(<span class="hljs-string">'email'</span>)
  }</pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <p>Sign in with the professor’s email, and
if the professor doesn’t have a Sinch WebRTC account, create one for the professor.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  sinchClient.newUser(signUpObj).then(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(ticket)</span></span>{
    sinchClient.start(ticket);
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'******sinch client ticket started******'</span>)
  }).fail(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(error)</span></span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'******* user may already exist, logging in with existing email *******'</span>);
  
    sinchClient.start(signUpObj)
      .then(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'********** sinchClient signed up and logged in ********'</span>);
      })
      .fail(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(error)</span></span>{
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'********** sinch failed to log in: *******'</span>, error)
      })
  });


  <span class="hljs-keyword">return</span> {
    call: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(userID)</span> </span>{
      <span class="hljs-keyword">var</span> callListeners = {
        onCallEstablished: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(currentCall)</span> </span>{
          $(<span class="hljs-string">'audio'</span>).attr(<span class="hljs-string">'src'</span>, currentCall.incomingStreamURL);
          currentCall.mute();
          <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"******call established*******"</span>);
        }
      };
      
      <span class="hljs-keyword">var</span> callClient = sinchClient.getCallClient();
      <span class="hljs-keyword">var</span> newCall = callClient.callUser(userID);
      newCall.addEventListener(callListeners);
    }
  }  

})</pre></div></div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <h2 id="socket-factory">Socket Factory</h2>

            </div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>angular.module(<span class="hljs-string">'socket.io'</span>, [])
.factory(<span class="hljs-string">'socket'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">($rootScope, teacherData)</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-27">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-27">&#182;</a>
              </div>
              <p>Create connection with server that is within the
factory (maintains connection across different views)
and send teacher email to associate with socketID on server</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">var</span> socketio = io.connect( $rootScope.serverURL );</pre></div></div>
            
        </li>
        
        
        <li id="section-28">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-28">&#182;</a>
              </div>
              <p>Wrapped socket.IO methods (on, emit, removeListener(s))
so that they can be handled correctly within view scopes</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">return</span> {
    on: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(event, cb)</span> </span>{
      socketio.on(event, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">var</span> args = <span class="hljs-built_in">arguments</span>;
        $rootScope.$apply(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
          cb.apply(socketio,args);
        })
      });
    },

    emit: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(event, data, cb)</span> </span>{
      <span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> cb === <span class="hljs-string">'function'</span>) {
        socketio.emit(event, data, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
          <span class="hljs-keyword">var</span> args = <span class="hljs-built_in">arguments</span>;
          $rootScope.$apply(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            cb.apply(socketio, args);
          })
        })
      } <span class="hljs-keyword">else</span> {
        socketio.emit(event, data);
      }
    },

    off: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(event, cb)</span> </span>{
      <span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> cb === <span class="hljs-string">'function'</span>) {
        socketio.removeListener(event, cb);
      } <span class="hljs-keyword">else</span> {
        socketio.removeAllListeners(event);
      }
    }
  }
});</pre></div></div>
            
        </li>
        
        
        <li id="section-29">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-29">&#182;</a>
              </div>
              <h2 id="teacher-data-factory">Teacher Data Factory</h2>

            </div>
            
        </li>
        
        
        <li id="section-30">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-30">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>angular.module(<span class="hljs-string">'queup.teacher'</span>, [])

.factory(<span class="hljs-string">'teacherData'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">($http, queupFactory, $rootScope, $q)</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-31">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-31">&#182;</a>
              </div>
              <p>private data for teacher information (name, email, classes, etc.)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">var</span> _data = {
    name: <span class="hljs-literal">null</span>,
    email: <span class="hljs-literal">null</span>,
    fbPicture: <span class="hljs-literal">null</span>,
    classes: [],
    currentClass: {id: <span class="hljs-literal">null</span>, name: <span class="hljs-literal">null</span>},
    loaded: <span class="hljs-literal">false</span>,
    loading: <span class="hljs-literal">false</span>
  };

  <span class="hljs-keyword">return</span> {

    set: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(key, value)</span> </span>{
      _data[key] = value;
    },

    get: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(key)</span> </span>{
      <span class="hljs-keyword">var</span> dataCopy;</pre></div></div>
            
        </li>
        
        
        <li id="section-32">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-32">&#182;</a>
              </div>
              <p>if a key is supplied, return that value
if no argument supplied, just return a deep copy of all teacher data</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">if</span>(key) {</pre></div></div>
            
        </li>
        
        
        <li id="section-33">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-33">&#182;</a>
              </div>
              <p>if value is an array, make a deep copy, otherwise make simple copy</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">Array</span>.isArray(_data[key]) || <span class="hljs-keyword">typeof</span> _data[key] === <span class="hljs-string">'object'</span>) {
          dataCopy = angular.copy(_data[key]);
        } <span class="hljs-keyword">else</span> {
          dataCopy = _data[key];
        }
      } <span class="hljs-keyword">else</span> {
        dataCopy = angular.copy(_data);
      }

      <span class="hljs-keyword">return</span> dataCopy;
    },
    
    update: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(caller)</span> </span>{
      <span class="hljs-keyword">var</span> token = <span class="hljs-built_in">window</span>.localStorage.getItem(<span class="hljs-string">'clientToken'</span>);

      <span class="hljs-keyword">var</span> deferred = $q.defer();

      <span class="hljs-keyword">if</span>(_data.loading === <span class="hljs-literal">false</span>) {
        _data.loading = deferred.promise;
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'making get request thanks to:'</span>, caller)
        <span class="hljs-keyword">return</span> $http({
          method: <span class="hljs-string">'GET'</span>,
          url: $rootScope.serverURL + <span class="hljs-string">'/api/teachers/getTeacherData'</span>,
          headers: {
            user_role: <span class="hljs-string">'teacher'</span>,
            access_token: token
          }
        })
        .success(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(data)</span> </span>{
          _data.name = data.name;
          _data.email = data.email;
          _data.fbPicture = data.fbPicture;
          _data.classes = data.classes;
          _data.loaded = <span class="hljs-literal">true</span>;
          deferred.resolve(<span class="hljs-string">'loaded teacher data'</span>);
          _data.loading = <span class="hljs-literal">false</span>;
          <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'successfully loaded teacherData'</span>, _data);
        })
        .error(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(data, status)</span> </span>{
          <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'error in teacherData.update function'</span>);
          _data.loading.reject(<span class="hljs-string">'failure to load teacher data'</span>);
          _data.loading = <span class="hljs-literal">false</span>;
        })
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">return</span> _data.loading;
      }
    }
  }
})
angular.module(<span class="hljs-string">'queup.before'</span>, [])

.controller(<span class="hljs-string">'Before_sessionController'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{


});
angular.module(<span class="hljs-string">'queup.class_list'</span>, [])</pre></div></div>
            
        </li>
        
        
        <li id="section-34">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-34">&#182;</a>
              </div>
              <h2 id="class-list-controller">Class List Controller</h2>

            </div>
            
        </li>
        
        
        <li id="section-35">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-35">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
        
        <li id="section-36">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-36">&#182;</a>
              </div>
              <p>Provides a list of all classes this professor is teaching</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>.controller(<span class="hljs-string">'Class_listController'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">($scope, queupFactory, $state, teacherData)</span></span>{
  $scope.classes = teacherData.get(<span class="hljs-string">'classes'</span>);
  $scope.numberOfClasses = $scope.classes.length;
  $scope.numberOfParticipants = <span class="hljs-number">0</span>;

  <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; $scope.classes.length; i++) {
    $scope.numberOfParticipants += $scope.classes[i].students.length;
  }</pre></div></div>
            
        </li>
        
        
        <li id="section-37">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-37">&#182;</a>
              </div>
              <p>If teacher has no classes, set variables to show No Classes div</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  $scope.hasClasses = ($scope.classes.length&gt;<span class="hljs-number">0</span>) ? <span class="hljs-literal">true</span> : <span class="hljs-literal">false</span> ;
  $scope.noClasses = !$scope.hasClasses;

  $scope.handleClick = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(classObj)</span></span>{
    teacherData.set(<span class="hljs-string">'currentClass'</span>, classObj);
    $state.go(<span class="hljs-string">'q.in_session.student_list'</span>)
  }

});
angular.module(<span class="hljs-string">'queup.new_class'</span>, [])</pre></div></div>
            
        </li>
        
        
        <li id="section-38">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-38">&#182;</a>
              </div>
              <h2 id="create-class-controller">Create Class Controller</h2>

            </div>
            
        </li>
        
        
        <li id="section-39">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-39">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
        
        <li id="section-40">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-40">&#182;</a>
              </div>
              <p>Allows professor to create a new class</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>.controller(<span class="hljs-string">'New_classController'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">($scope, $http, queupFactory, $state, teacherData)</span></span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-41">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-41">&#182;</a>
              </div>
              <p>Adds the newly created class to the teacher database</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  $scope.addNewClass = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(newClassName)</span></span>{
    queupFactory.addNewClass(newClassName)
                .then(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(data)</span></span>{
                  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"data returning back to new class.js: "</span>);
                  <span class="hljs-built_in">console</span>.dir(data);
                  teacherData.update().then(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
                    $state.go(<span class="hljs-string">'q.before_session.class_list'</span>);
                  })
    })
  };

});

angular.module(<span class="hljs-string">'queup.in_session'</span>, [])</pre></div></div>
            
        </li>
        
        
        <li id="section-42">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-42">&#182;</a>
              </div>
              <p>In-Session Class Info Controller</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>.controller(<span class="hljs-string">'In_sessionController'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">($scope, teacherData)</span></span>{
  $scope.currentClassname = teacherData.get(<span class="hljs-string">'currentClass'</span>).name;
  $scope.classes = teacherData.get(<span class="hljs-string">'classes'</span>);
  $scope.numberOfClasses = $scope.classes.length;
  $scope.studentsInClass = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; $scope.classes.length; i++) {
    <span class="hljs-keyword">if</span>($scope.classes[i].name === $scope.currentClassname) {
      $scope.studentsInClass += $scope.classes[i].students.length;
    }
  }
});
angular.module(<span class="hljs-string">'queup.queue_list'</span>, [])</pre></div></div>
            
        </li>
        
        
        <li id="section-43">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-43">&#182;</a>
              </div>
              <h2 id="queue-list-controller">Queue List Controller</h2>

            </div>
            
        </li>
        
        
        <li id="section-44">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-44">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
        
        <li id="section-45">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-45">&#182;</a>
              </div>
              <p>Monitors current queue state, and manages socket interaction between teacher and server</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>.controller(<span class="hljs-string">'Queue_listController'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">($state, $scope, socket, teacherData, sinch)</span></span>{

  <span class="hljs-keyword">var</span> currentClass = teacherData.get(<span class="hljs-string">'currentClass'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-46">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-46">&#182;</a>
              </div>
              <p>If there is no current class, redirect to class list 
so things don’t break due to undefined currentClass</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">if</span>( currentClass.id === <span class="hljs-literal">null</span>) { $state.go(<span class="hljs-string">'q.before_session.class_list'</span>); <span class="hljs-keyword">return</span>; }</pre></div></div>
            
        </li>
        
        
        <li id="section-47">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-47">&#182;</a>
              </div>
              <p>Emit event to register class id with socket id on server (for routing socket messages from students to teacher)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  socket.emit(<span class="hljs-string">'classReady'</span>, {classID: currentClass.classID});</pre></div></div>
            
        </li>
        
        
        <li id="section-48">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-48">&#182;</a>
              </div>
              <p>Get current class info to display, and for sending on server reqs</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  $scope.currentClass = {id: currentClass.classID, name: currentClass.name};

  $scope.queue = [];
  $scope.hasQuestions = <span class="hljs-literal">true</span>;
  $scope.noQuestions = <span class="hljs-literal">false</span>;

  $scope.modal = {
    name: <span class="hljs-string">""</span>,
    fbPicture: <span class="hljs-string">""</span>,
    email: <span class="hljs-string">""</span>,
    timer: <span class="hljs-number">0</span>
  };</pre></div></div>
            
        </li>
        
        
        <li id="section-49">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-49">&#182;</a>
              </div>
              <p>Call on student, send id and index in the queue so it can be returned/confirmed as received</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  $scope.handleClick = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(student, index)</span> </span>{
    $scope.modal = {
      name: student.name,
      fbPicture: student.fbPicture,
      email: student.email,
      timer: student.timer
    };
    
    clearInterval(student.timerID);
    socket.emit(<span class="hljs-string">'callOnStudent'</span>, {email: student.email, index: index, classID: currentClass.classID});

    $(<span class="hljs-string">'#aModal'</span>).modal(<span class="hljs-string">'show'</span>);
    sinch.call(student.email)
  };

  <span class="hljs-keyword">var</span> removeFromQueue = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(student)</span> </span>{
    $scope.queue.splice(student.index,<span class="hljs-number">1</span>);

    $(<span class="hljs-string">'.questions'</span>).html($scope.queue.length);

    <span class="hljs-keyword">if</span>($scope.queue.length === <span class="hljs-number">0</span>) {
      $scope.hasQuestions = <span class="hljs-literal">false</span>;
      $scope.noQuestions = <span class="hljs-literal">true</span>;
    }
    $(<span class="hljs-string">'#aModal'</span>).modal(<span class="hljs-string">'hide'</span>);
  };


  <span class="hljs-keyword">var</span> addStudentToList = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(data)</span> </span>{
    data.timer = <span class="hljs-number">0</span>;
    data.timerID = setInterval(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">($scope)</span> </span>{
      <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>
      $scope.$apply(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
        self.timer++;
      });
    }.bind(data, $scope), <span class="hljs-number">60000</span>);

    $scope.queue.push(data);
    
    $(<span class="hljs-string">'.questions'</span>).html($scope.queue.length);</pre></div></div>
            
        </li>
        
        
        <li id="section-50">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-50">&#182;</a>
              </div>
              <p>send confirmation to student that they were added to list</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    socket.emit(<span class="hljs-string">'studentAddedToQueue'</span>, data)
    $scope.hasQuestions = <span class="hljs-literal">true</span>;
    $scope.noQuestions = <span class="hljs-literal">false</span>;
  };</pre></div></div>
            
        </li>
        
        
        <li id="section-51">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-51">&#182;</a>
              </div>
              <p>Listen for queue updates from server</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  socket.on(<span class="hljs-string">'studentRaisedHand'</span>, addStudentToList);</pre></div></div>
            
        </li>
        
        
        <li id="section-52">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-52">&#182;</a>
              </div>
              <p>If server confims student receieved call, remove from queue</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  socket.on(<span class="hljs-string">'studentConfirmation'</span>, removeFromQueue);</pre></div></div>
            
        </li>
        
        
        <li id="section-53">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-53">&#182;</a>
              </div>
              <p>Ask for queue of current class from server when view gets instantiated</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  socket.emit(<span class="hljs-string">'queueRequest'</span>, {classID: $scope.currentClass.classID, data: <span class="hljs-string">'give me the queue'</span>});</pre></div></div>
            
        </li>
        
        
        <li id="section-54">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-54">&#182;</a>
              </div>
              <p>Remove listeners to avoid memory leak when user leaves view and comes back</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  $scope.$on(<span class="hljs-string">'$destroy'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
    socket.off(<span class="hljs-string">'studentRaisedHand'</span>, addStudentToList);
    socket.off(<span class="hljs-string">'studentReceivedCall'</span>, removeFromQueue);
  });

});
angular.module(<span class="hljs-string">'queup.student_list'</span>, [])</pre></div></div>
            
        </li>
        
        
        <li id="section-55">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-55">&#182;</a>
              </div>
              <h2 id="student-list-controller">Student List Controller</h2>

            </div>
            
        </li>
        
        
        <li id="section-56">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-56">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
        
        <li id="section-57">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-57">&#182;</a>
              </div>
              <p>Shows all students enrolled in the current class</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>.controller(<span class="hljs-string">'Student_listController'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">($scope, queupFactory, $state, teacherData)</span></span>{
  $scope.students = [];
  $scope.noStudents = <span class="hljs-literal">true</span>;
  $scope.hasStudents = <span class="hljs-literal">false</span>;

  <span class="hljs-keyword">var</span> currentClass = teacherData.get(<span class="hljs-string">'currentClass'</span>);
  <span class="hljs-keyword">var</span> classes = teacherData.get(<span class="hljs-string">'classes'</span>);
  $scope.className = currentClass.name;

  classes.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(thisClass)</span> </span>{
    <span class="hljs-keyword">if</span>(thisClass.classID === currentClass.classID) {
      <span class="hljs-keyword">if</span>(currentClass.students.length &gt; <span class="hljs-number">0</span>) {
        $scope.students = currentClass.students;
        $scope.noStudents = <span class="hljs-literal">false</span>;
        $scope.hasStudents = <span class="hljs-literal">true</span>;
      }
    }
  });
});</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
